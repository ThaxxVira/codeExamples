%  Program Name:         Plot_of_Several_Atmospheres
%  File Name:            Plot_of_Several_Atmospheres.m
%  Functions Required:   MATLAB functions
%-----------------------------------------------------------------------------------------
%  Program Description:
%
%   This program plots pressure as a function of altitude for:
%   (a) The isothermal atmosphere (T = 273 K, surface temp = 300 K, surface pressure = 1000hPa)
%   (b) A dry adiabatic atmosphere (using same values as (a))
%   (c) The 1976 US Standard Atmosphere
%   (d) Radiosonde data (hardcoded)
%-----------------------------------------------------------------------------------------
%  Author:  Matthew B. Little
%  Date:    11 Apr 2011     
%  Revised: 7 Sep 2016 
%-----------------------------------------------------------------------------------------
%        1         2         3         4         5         6         7         8         9
%23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
% Reset any leftover graphics and variables
  clear
  clf('reset');
% Initialize values for part a and b
  z = 0:1:30;
  g = 9.81;
  R = 287;
  p = 1000;
  T = 273;
  c = 1004.64;
  Gam = 9.8;
% Part a, The isothermal atmosphere
p1 = p*(exp((-g.*z*1000)/(R*T)));
% Part b, The dry adiabatic atmosphere
p2 = p*((T - Gam.*z)/T).^(c/R);
p2(29:31) = 0;
% Part c, The 1976 US Standard Atmosphere
% Initialize variables
  T_c = 288.15;
  P_c = 1013.25;
  g_c = 9.80665;
  Gam_c = 6.5;
  TS_c = 216.65;
  z1_c = 0:1:11;
  z2_c = 12:1:21;
  % Wikipedia provided the Stratospheric info for z > 20gpkm   
  Gam2_c = -1.0;
% Using Barometric formula 
p3(1) = P_c;
T3(1) = T_c;
for counter = 1:11
    T3(counter + 1) = T3(counter) - Gam_c;
    p3(counter + 1) = p3(counter)*(exp((-g_c*1000)/(R*T3(counter + 1))));
end
% For tropopause 12gpkm - 19 gpkm
T3(z2_c) = TS_c;
for counter2 = 12:20
    p3(counter2 + 1) = p3(counter2)*(exp((-g_c*1000)/(R*T3(counter2 + 1))));
end
% For stratosphere for 20gpkm to 30gpkm
for counter3 = 21:30
    T3(counter3 + 1) = T3(counter3) - Gam2_c;
    p3(counter3 + 1) = p3(counter3)*(exp((-g_c*1000)/(R*T3(counter3 + 1))));
end
% Part d, Hardcoded Radiosonde Data
p4 = [1018.3,1018.2,1016.6,1013.3,1009.9,1006.5,1003,1000,997,994.4,991.2,987.8,985.1,981.5,978.1,974.8,971.5,948.2,965,961.7,957.9,955.4,948.3,933.6,931.1,927.2,921.7,914.8,911.4,908.8,903.4,899.8,897.4,893.7,891.4,888.1,885.8,882.2,879.7,877.5,872.5,865.4,862.1,860.3,858.7,854.2,845.8,839.6,835.5,830.2,826.5,822.4,817.2,809,808.6,778.7,797.3,784.5,767.2,757.3,726.6,687.5,437.6,428.2,426.8,424.6,423.5,422.3,421.4,419.3,418.2,417.5,415.9,415,414,413,411,408.9,406.9,405.9,404.5,402.9,401.5,400.5,398.9,397.2,395.9,394.4,392.8,391,389.8,388.2,386.9,384.6,384.5,382.9,381.9,380.5,379.6,378.3,376.9,375.7,375,372.9,371.4,369,367.2,363.9,362.8,361.8,360.5,359.2,358.4,357.2,355.8,354.9,354.5,353.3,351.2,349.3,347,345.5,344.3,343.5,342.1,341,340.6,339.4,338,336.8,335.6,334.1,333.7,332.4,332,329.7,328.7,327.2,326.2,325.2,324,323.2,322.4,321.5,320.4,318.8,317.7,315.5,313.8,312.3,310.4,308,306,305.4,303.9,302.8,302.4,300.8,299.9,298,297.2,295.6,294.8,294.1,277.1,292.1,291.2,290.5,289.8,287.7,287.2,285.5,284.5,283.9,282.7,280.6,280,279,277.9,277.1,277.4,275.1,274.7,273.6,272.3,259.6,270.4,269.3,268.2,267.9,266.6,265.9,265.2,263.8,264.4,262.2,262.1,260.4,259.5,259.4,258.5,257.3,256.6,255.4,254.2,253.5,252.8,251.7,251.8,250,250.7,247.8,249,246.8,246.5,246.2,244.5,243.9,242.6,242,240.7,240.4,239.6,238.8,237.9,237.3,236.6,236.2,234.6,233.7,232.6,232.7,231.3,231,229.9,229.3,228.6,227.3,227.1,226.1,225.6,224.5,224.2,223.4,222.8,223,221.2,219.7,219.1,218.4,217.7,217.3,215.8,215.2,214.2,213.6,213.4,212.3,212.3,211,210.4,187,186.4,185.7,184.8,184.1,183.6,183.1,182.2,181.8,181.3,180.5,180.1,179.9,179,178.6,178,177.1,176.6,175.6,174.8,174.6,174.8,172.8,172.6,221.3,172.4,170,170.7,169.6,170,167,167,166.5,165.6,165.6,164.9,163.1,162.6,162,161.5,161.1,160.6,160.1,159.6,159.1,158.7,158,157.7,157.3,156.8,156.2,155.8,155.2,154.6,153.9,153.3,152.9,152.4,151.8,151.2,150.8,150.4,149.9,149.2,148.8,148.4,147.8,147.3,147,146.2,146,145.4,144.9,144.6,144.1,144,143,142.7,142.3,141.7,141.3,140.8,140.3,139.8,139.4,139.1,138.5,138.3,137.8,137.2,137,136.6,136.2,135.7,135,134.8,134.3,134,133.6,133.2,132.8,132.6,132.1,131.7,131.1,131.2,130.5,130.2,130.2,129.2,128.9,128.7,128.3,127.7,127.5,127.1,126.7,126.4,125.8,125.5,125.3,124.8,124.7,124.2,123.6,123.4,123,122.8,122.2,122,121.7,121.4,120.9,120.6,120.2,120.1,119.4,119.3,119,118.3,117.9,117.7,117.3,116.8,116.9,116.3,116.1,115.7,115.4,115.2,114.5,114.3,114.2,113.5,113.4,113.7,112.6,112.2,112.2,111.7,111.3,110.9,110.9,110.5,110.4,109.6,109.6,109.2,109.1,108.7,108.6,108.2,108.3,107.5,107.1,107.3,106.9,106.4,105.7,105.9,105.8,105.7,105.3,104.7,104.6,104.4,104.2,103.7,103.9,103.3,103,103.3,102.9,102.9,102.6,102.3,101.7,102,101.3,102,101.6,101.4,101.7,99.9,100.3,97.9,86.2,97.9,97.5,97.2,96.9,97.2,97.3,97,98.8,94.6,86.1];
z4 = [40,40.8,54.1,81.5,109.7,138,167.2,192.3,217.5,239.3,266.2,294.9,317.8,348.3,377.2,405.4,433.6,635.4,489.5,517.9,550.8,572.4,634.1,763.1,785.2,819.8,868.7,930.4,960.9,984.4,1033.2,1065.9,1087.7,1121.5,1142.6,1172.8,1194,1227.2,1250.3,1270.6,1317,1383.3,1414.2,1431.1,1446.2,1488.6,1568.3,1627.5,1666.8,1718,1753.8,1793.6,1844.3,1924.9,1928.8,2229.1,2040.1,2170.5,2350.4,2454.8,2785.9,3225.3,6654.4,6811.9,6835.6,6872.9,6891.6,6912.1,6927.5,6963.5,6982.5,6994.5,7022.1,7037.7,7055,7072.4,7107.2,7144,7179.2,7196.8,7221.5,7249.8,7274.7,7292.5,7321,7351.5,7374.8,7401.8,7430.6,7463.2,7485,7514.1,7537.8,7579.9,7581.8,7611.2,7629.6,7655.5,7672.2,7696.4,7722.5,7744.9,7757.9,7797.3,7825.6,7870.9,7905.1,7968,7989,8008.2,8033.2,8058.3,8073.7,8097,8124.2,8141.7,8149.5,8173,8214.1,8251.5,8297,8326.8,8350.7,8366.7,8394.7,8416.8,8424.9,8449,8477.3,8501.6,8525.9,8556.5,8564.6,8591.2,8599.3,8646.5,8667.1,8698,8718.7,8739.5,8764.5,8781.2,8798,8816.9,8840,8873.7,8897,8943.7,8980,9012.1,9052.9,9104.8,9148.3,9161.3,9194.2,9218.4,9227.2,9262.5,9282.4,9324.5,9342.3,9378.1,9396,9411.8,9805.4,9456.6,9477.1,9493,9508.9,9557,9568.5,9607.8,9630.9,9644.9,9672.7,9721.7,9735.8,9759.3,9785.2,9804.1,9797,9851.6,9861.1,9887.4,9918.6,10230.5,9964.3,9990.9,10017.6,10024.9,10056.6,10073.7,10090.9,10125.3,10110.5,10164.8,10167.3,10209.5,10232,10234.5,10257,10287.1,10304.7,10335,10365.5,10383.3,10401.1,10429.3,10426.7,10473,10455,10530.1,10498.9,10556.1,10564,10571.8,10616.3,10632.1,10666.4,10682.3,10716.8,10724.7,10746.1,10767.5,10791.7,10807.9,10826.9,10837.7,10881.3,10905.9,10936.2,10933.4,10972.1,10980.4,11011,11027.7,11047.3,11083.8,11089.4,11117.7,11131.8,11163.2,11171.7,11194.7,11212,11206.2,11258.3,11302,11319.6,11340.2,11360.8,11372.6,11417.2,11435.1,11465,11483.1,11489.1,11522.5,11522.5,11562.2,11580.6,12338,12358.6,12382.7,12413.8,12438.2,12455.7,12473.2,12504.9,12519,12536.7,12565.1,12579.4,12586.5,12618.7,12633.1,12654.7,12687.2,12705.4,12741.8,12771.2,12778.6,12771.2,12845.4,12852.8,11249.4,12888.5,12980.6,12954,12996,12980.7,13096.4,13096.4,13115.9,13151.2,13151.2,13178.8,13250.5,13270.6,13294.8,13315.1,13331.3,13351.7,13372.2,13392.7,13413.3,13429.8,13458.8,13471.2,13487.9,13508.8,13534,13550.8,13576.2,13601.7,13631.5,13657.2,13674.3,13695.8,13721.7,13747.6,13765,13782.3,13804,13834.6,13852,13869.6,13895.9,13918,13931.2,13966.7,13975.6,14002.3,14024.7,14038.1,14060.6,14065.1,14110.3,14123.9,14142.1,14169.4,14187.6,14210.5,14233.4,14256.5,14274.9,14288.8,14316.7,14326,14349.3,14377.4,14386.8,14405.7,14424.6,14448.3,14481.7,14491.2,14515.2,14529.6,14548.9,14568.3,14587.8,14597.5,14621.9,14641.5,14671.1,14666.1,14700.8,14715.6,14715.6,14765.6,14780.7,14790.8,14810.9,14841.3,14851.4,14871.7,14892.1,14907.5,14938.2,14953.6,14963.9,14989.7,14994.8,15020.7,15052,15062.4,15083.3,15093.8,15125.4,15135.9,15151.7,15167.6,15194.1,15210.1,15231.4,15236.7,15274.2,15279.6,15295.8,15333.6,15355.4,15366.2,15388.1,15415.4,15409.9,15442.8,15453.8,15475.9,15492.5,15503.6,15542.5,15553.6,15559.2,15598.5,15604.1,15587.2,15649.3,15672,15672,15700.6,15723.5,15746.5,15746.5,15769.6,15775.4,15821.7,15821.7,15845,15850.8,15874.3,15880.2,15903.8,15897.9,15945.2,15969,15957.1,15980.9,16010.9,16053.1,16041,16047,16053.1,16077.3,16113.8,16119.9,16132.1,16144.4,16175.1,16162.8,16199.9,16218.5,16200,16224.8,16224.8,16243.4,16262.2,16300,16281,16325.4,16281,16306.3,16319,16300,16414.8,16389.1,16544.1,17353.1,16544.8,16570.9,16590.5,16610.2,16590.5,16583.9,16603.6,16486.2,16763.6,17364.1]./1000;

% Plots all atmosphere data on a single figure
plot(p1,z,'b','DisplayName','Isothermal Atmosphere');
  hold on;
  plot(p2,z,'g','DisplayName','Dry Adiabatic Atmosphere');
  plot(p3,z,'r','DisplayName','The 1976 US Standard Atmosphere');
  plot(p4,z4,'c', 'DisplayName','Radiosonde Data');
  hold off;
    title('Pressure as a Function of Altitude for Several Atmospheres');
    ylabel('Height (km)');
    xlabel('Pressure (mb)');
      set(gca,'XDir','Reverse');
    legend('show', 'Location','northwest');
